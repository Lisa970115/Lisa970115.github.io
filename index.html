<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的 GitHub Pages 網站</title>
</head>
<body>
    <h1 style="text-align: center;">歡迎商店ﾉ</h1>
    <p >嘿嘿</p>
    <script type="module">
        // 1️⃣ 引入 Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

        // 2️⃣ 設定 Firebase
        const firebaseConfig = {
            apiKey: "你的API金鑰",
            authDomain: "你的專案ID.firebaseapp.com",
            databaseURL: "https://你的專案ID.firebaseio.com",
            projectId: "你的專案ID"
        };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const ordersRef = ref(db, "orders");

        // 3️⃣ 訂單處理邏輯
        let cart = [];
        let total = 0;

        function addToCart(item, price) {
            cart.push({ item, price });
            total += price;
            updateCart();
        }

        function updateCart() {
            let cartList = document.getElementById("cart-items");
            let totalAmount = document.getElementById("total");
            cartList.innerHTML = "";
            cart.forEach((c, index) => {
                cartList.innerHTML += `<li>${c.item} - $${c.price} <button onclick="removeFromCart(${index})">移除</button></li>`;
            });
            totalAmount.innerText = total;
        }

        function removeFromCart(index) {
            total -= cart[index].price;
            cart.splice(index, 1);
            updateCart();
        }

        function generateOrderId() {
            let now = new Date();
            let timestamp = now.getFullYear().toString() +
                            (now.getMonth() + 1).toString().padStart(2, '0') +
                            now.getDate().toString().padStart(2, '0') +
                            now.getHours().toString().padStart(2, '0') +
                            now.getMinutes().toString().padStart(2, '0') +
                            now.getSeconds().toString().padStart(2, '0');
            let randomNum = Math.floor(Math.random() * 900) + 100;
            return `ORD-${timestamp}-${randomNum}`;
        }

        function checkout() {
            if (cart.length === 0) {
                alert("購物車是空的，請選擇商品！");
                return;
            }

            let orderId = generateOrderId();
            let order = {
                id: orderId,
                items: cart,
                total: total,
                time: new Date().toLocaleString()
            };

            // 4️⃣ 將訂單存入 Firebase
            push(ordersRef, order);

            alert("訂單提交成功！您的訂單編號：" + orderId);

            cart = [];
            total = 0;
            updateCart();
        }
    </script>
</head>
<body>

    <h1>線上點餐系統</h1>

    <div id="menu">
        <button onclick="addToCart('漢堡', 100)">漢堡 - $100</button>
        <button onclick="addToCart('薯條', 50)">薯條 - $50</button>
    </div>

    <div id="cart">
        <h2>購物車</h2>
        <ul id="cart-items"></ul>
        <p>總金額：$<span id="total">0</span></p>
        <button onclick="checkout()">提交訂單</button>
    </div>

</body>
</html>
